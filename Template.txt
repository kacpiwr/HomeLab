# Lab Report: [INSERT LAB TITLE, e.g., Network Reconnaissance with Nmap]

    | **Category** | **Date** | **Difficulty** | **Status** |
    |:---:|:---:|:---:|:---:|
    | Red Team / Blue Team / Purple Team | 2025-12-[DAY] | Basic / Intermediate / Advanced | âœ… Completed |

    ## 1. Objective
    The goal of this lab was to simulate [describe the attack briefly, e.g., a port scanning attack] and verify if the SIEM (Splunk) could detect the generated network noise.

    ## 2. MITRE ATT&CK Mapping
    * **Tactic:** [e.g., Discovery]
    * **Technique:** [e.g., T1046 - Network Service Discovery]
    * **Procedure:** Using `[Tool Name]` to identify open ports on the target machine.

    ---

    ## 3. Red Team Operations (Attack Simulation)
    **Tools used:** [e.g., Kali Linux, Nmap, Hydra]
    **Target:** [e.g., Ubuntu Server (192.168.x.x)]

    ### Execution
    The following command was executed to initiate the activity:

    ```bash
    [PASTE YOUR COMMAND HERE, e.g., nmap -sV 192.168.1.105]

    Observation: [Briefly describe what happened, e.g., The scan revealed open ports 22 (SSH) and 80 (HTTP).]
    4. Blue Team Operations (Detection & Analysis)

    Tool: Splunk Enterprise Log Source: [e.g., /var/log/syslog OR network_traffic]
    Detection Logic (SPL)

    To detect this activity, I used the following Splunk search query:
    Fragment kodu

    [PASTE YOUR SPLUNK QUERY HERE]

    Analysis Breakdown

        index=...: Defines the data scope.

        [Specific Command]: [Explain why you used it, e.g., Used stats count to identify high volume of connections].

        Threshold: [Optional: Explain your logic, e.g., Alert triggers if connection attempts > 100].

    5. Business Impact & Mitigation

        Risk: [Why is this bad?, e.g., Allows attackers to map the network and find vulnerable services.]

        Mitigation: [How to fix it?, e.g., Implement strict Firewall rules, disable unused ports, use Port Security.]

    6. Lessons Learned

        [What did you learn?, e.g., I learned that Nmap generates massive amounts of logs, making it easy to detect without stealth flags.]


---

### ðŸ’¡ PrzykÅ‚ad wypeÅ‚nienia (Dla Laba 5: Nmap Scan)

    Å»ebyÅ› wiedziaÅ‚, jak to ma wyglÄ…daÄ‡ finalnie, oto przykÅ‚ad wypeÅ‚nionego szablonu dla skanowania Nmapem:

    ```markdown
    # Lab Report: Network Service Discovery (Nmap)

    | **Category** | **Date** | **Difficulty** | **Status** |
    |:---:|:---:|:---:|:---:|
    | Purple Team | 2025-12-11 | Basic | âœ… Completed |

    ## 1. Objective
    The goal of this lab was to simulate a reconnaissance phase using Nmap to identify open services on the target server and create a Splunk detection rule for horizontal scanning.

    ## 2. MITRE ATT&CK Mapping
    * **Tactic:** Discovery
    * **Technique:** T1046 - Network Service Discovery
    * **Procedure:** Aggressive scanning of the victim machine to enumerate versions.

    ---

    ## 3. Red Team Operations (Attack Simulation)
    **Tools used:** Kali Linux, Nmap
    **Target:** Ubuntu Server (192.168.1.20)

    ### Execution
    The following command was executed to initiate a version detection scan:

    ```bash
    nmap -sV -T4 192.168.1.20

    Observation: The scan successfully identified OpenSSH 8.2p1 and Apache httpd 2.4.41 running on the target.
    4. Blue Team Operations (Detection & Analysis)

    Tool: Splunk Enterprise Log Source: /var/log/syslog (UFW Logs)
    Detection Logic (SPL)

    To detect the sudden spike in connection attempts, I used:
    Fragment kodu

    index=main "UFW BLOCK" 
    | stats count by src_ip 
    | where count > 50
    | sort - count

    Analysis Breakdown

        index=main "UFW BLOCK": Filters logs generated by the Uncomplicated Firewall (UFW).

        stats count by src_ip: Groups the events by the attacker's IP address.

        where count > 50: Sets a threshold to ignore random internet noise; only aggressive scans are shown.

    5. Business Impact & Mitigation

        Risk: Unchecked scanning allows adversaries to identify vulnerable software versions (e.g., outdated SSH) and plan specific exploits.

        Mitigation: Configure Firewall (UFW/IPTables) to drop unsolicited traffic and implement IPS (Intrusion Prevention Systems) to block scanning IPs automatically.

    6. Lessons Learned

        I learned that a simple -T4 scan generates enough noise to be easily detected by basic threshold rules in Splunk.